function parseAndStorage(e,a,t){var n=!1,r=[],s="ls_"+e;return r=t.get(s),null==r&&(r=[]),-1==r.indexOf(a)?(r.push(a),t.put(s,r)):n=!0,n}function parseStorage(e){if(null!=e){var a="";return angular.forEach(e,function(e){a+=e+" OR "}),a=a.slice(0,a.length-4)}}function parseStorageAndSwitch(e,a){if(null!=e){var t="";a=null==a||void 0==a?"OR":"AND",angular.forEach(e,function(e){t+=e+" "+a+" "});var n="OR"===a?4:5;return t=t.slice(0,t.length-n)}}function parseStage(e){if(null!=e){var a="";return angular.forEach(e,function(e){"PRE_A"==e&&(e="pre-A"),"LAST_STAGE"==e&&(e="Last Stage"),"UNKNOWN"==e&&(e="Unknown"),a+=e+" OR "}),a=a.slice(0,a.length-4)}}function parseStageValue(e){if(null!=e){var a="";return angular.forEach(e,function(e){301==e&&(a+="Angle OR "),302==e&&(a+="Pre-A OR "),303==e&&(a+="Serials A OR "),304==e&&(a+="Serials B OR "),305==e&&(a+="Serials C OR "),306==e&&(a+="Serials D OR "),307==e&&(a+="Serials E OR "),308==e&&(a+="Late Stage OR ")}),a=a.slice(0,a.length-4)}}function parseFinance(e){if(null!=e){var a=e.length;return a>9?e=e.substring(0,a-9)+"b":a>6?e=e.substring(0,a-6)+"m":a>3&&(e=e.substring(0,a-3)+"k"),(1e8==e||"100m"==e)&&(e="100m+"),e}}function openModalFilter(e,a,t,n,r,s,l){l=angular.lowercase(l);var i=n.open({animation:a.animationsEnabled,templateUrl:"./views/modal/"+l+"_modal.html",controller:"ModalInstanceCtrl"});i.result.then(function(){r.put("ls_page",1),change(e,a,t,r,s)})}function appendElement(e,a){var t='<div class="search-param label"> '+a+'<i class="fa fa-times close-filter" item-close-filter="'+e+'"></i></div> ';return t}function appendListSearch(e){var a='<div class="list-param label div-tag m-t-sm"  tooltip-placement="top" tooltip="Contains '+e.count+' Companies"select-list="'+e.listId+'">'+e.listName+'<i class="fa fa-plus"></i></div>';return a}function change(e,a,t,n,r){var s=getParams(e,a,t,n,r);$(".filter-selected").children("div").css("display","inline-block"),loadSearchData(e,a,t,n,r,s)}function getParams(e,a,t,n){var r=n.get("ls_change");if(r){a.name=n.get("ls_name"),a.keyword=n.get("ls_keyword"),a.keywordSwitch=n.get("ls_keyword_switch"),a.location=n.get("ls_location"),a.investor=n.get("ls_investor"),a.investorSwitch=n.get("ls_investor_switch"),a.stage=n.get("ls_stage"),a.foundedAfter=n.get("ls_founded_after"),a.foundedBefore=n.get("ls_founded_before"),a.page=n.get("ls_page"),a.stageValue=n.get("ls_stage_value"),e.nameSelected=parseStorage(a.name),e.keywordSelected=parseStorageAndSwitch(a.keyword,a.keywordSwitch),e.locationSelected=parseStorage(a.location),e.investorSelected=parseStorageAndSwitch(a.investor,a.investorSwitch),e.stageSelected=parseStage(a.stage),e.foundedAfter=a.foundedAfter,e.foundedBefore=a.foundedBefore;var s={};s.names=a.name,s.keywords=a.keyword,s.keywordSwitch=a.keywordSwitch,s.locations=a.location,s.investors=a.investor,s.investorSwitch=a.investorSwitch,s.stages=a.stageValue;var l=a.foundedAfter;null!=l&&(l=l.slice(6,10)+"-"+l.slice(0,2)+"-"+l.slice(3,5));var i=a.foundedBefore;null!=i&&(i=i.slice(6,10)+"-"+i.slice(0,2)+"-"+i.slice(3,5)),s.foundedAfter=l,s.foundedBefore=i,s.page=null==a.page?1:a.page;var o=angular.toJson(s);return console.log(o),n.put("ls_params",o),n.remove("ls_change"),o}}function loadSearchData(e,a,t,n,r,s){var l={method:"POST",url:"/api/search/company",headers:{"Content-Type":"application/json"},data:s,responseType:"json"},i=[];t(l).success(function(t){e.total=t.total,a.totalPage=t.total/100,i=t.companyIds}).then(function(){if(0==i.length){var e=[];return void r.newData(e)}var a={method:"POST",url:"./api/company/getCompanies",params:{ids:i}};t(a).success(function(e){r.newData(e.companyList)})})}function parseSearchParams(e,a){a.date=e("date")(a.createTime,"yyyy-MM-dd HH:mm:ss"),a.params=angular.fromJson(a.searchParams),a.params.names=parseStorage(a.params.names),a.params.keywords=parseStorage(a.params.keywords),a.params.locations=parseStorageAndSwitch(a.params.locations,a.params.keywordSwitch),a.params.investors=parseStorageAndSwitch(a.params.investors,a.params.investorSwitch),a.params.stages=parseStageValue(a.params.stages)}function keyUpOrDown(e,a){var t=e.next().children();if(0!=t.length){var n,r=t.first(),s=t.last(),l=!1;return t.each(function(){$(this).hasClass("result-select")&&(n="up"==a?$(this).children().text()==r.children().text()?s:$(this).prev():$(this).children().text()==s.children().text()?r:$(this).next(),l=!0)}),l||(n="up"==a?e.parent().children("span").last().children().last():e.parent().children("span").first().children().last()),"down"!=a||l||(n=r),n.addClass("result-select"),n.siblings().removeClass("result-select"),e.val(n.children().text()),n}}function autoComplete(e,a,t,n,r){var s=a.text().trim();if(console.log(s),void 0!=s&&null!=s&&""!=s){var l=parseAndStorage(t,s,n);if(!l){var i=r(appendElement(t,s))(e);a.parent().parent().children("span").first().append(i),n.put("ls_change",!0),$("#input-location").val(""),$("#input-keyword").val(""),$("#input-investor").val(""),$("#input-name").val(""),a.parent().css("display","none"),$("#div-"+t).is(":visible")||$("#div-"+t).css("display","inline-block")}}}function deleteOperation(e,a,t,n){var r="./api/user/";"delete"==t&&(r+="search/delete"),"deleteOwner"==t&&(r+="list/deleteOwner");var s={method:"delete",url:r,params:{id:n}};e(s).success(function(){var e="<div class='div-opearte-add pull-right'><i class='fa fa-check'></i><span>Delete Success</span></div>",t=a.offset().top;a.parent().parent().parent().parent().append(e),$(".div-opearte-add").css({top:t-23+"px",right:"3%",position:"absolute"}).fadeIn(500).delay(1e3).fadeOut(500),a.parent().parent().parent().fadeOut(1e3)})}function comfirm(e){var a=e.open({templateUrl:"./views/modal/user/comfirm_modal.html",controller:"BasicModalInstanceCtrl",resolve:{template:function(){return"comfirm"}}});return a}function alertDiv(e,a){var t="<div class='growl-container'><p>"+e+"</p><p>"+a+".</p></div>";$("#page-wrapper").append(t),$(".growl-container").delay(3e3).fadeOut(500)}function alertDeleteDiv(e,a){var t="<div class='growl-container'><p>"+e+"</p><p>"+a+".</p></div>";$("#page-wrapper").append(t),$(".growl-container").delay(3e3).fadeOut(500)}function doSearch(e,a,t,n,r,s,l,i){r.remove("ls_name"),r.remove("ls_keyword"),r.remove("ls_keyword_switch"),r.remove("ls_location"),r.remove("ls_investor"),r.remove("ls_investor_switch"),r.remove("ls_stage"),r.remove("ls_founded_after"),r.remove("ls_founded_before");var o=parseAndStorage(i,l,r);o||($("#top-search").val(""),r.put("ls_change",!0),change(e,a,t,r,s),n.path("/index/search"))}function getAllList(e,a,t,n){a.get("./api/user/list/getAll").success(function(a){e.allList=a.userList,e.total=e.allList.length}).then(function(){var r=[];if(t.get("ls_feature")){var s=n.absUrl().split("?")[1];(null==s||""==s)&&n.path("/index/my_list"),a.get("./api/user/list/getFeature?companyId="+s).success(function(e){r=e.userList}).then(function(){t.remove("ls_feature")})}else angular.forEach(e.allList,function(e,a){10>a&&this.push(e)},r);e.userList=r,e.userList.length>0&&$("#list-in-modal").show()})}
;$(document).ready(function(){function a(){var a=$("body > #wrapper").height()-61;$(".sidebard-panel").css("min-height",a+"px");var e=$("nav.navbar-default").height(),i=$("#page-wrapper").height(),s=$(window).height();$("#page-wrapper").css("min-height",s+"px"),null==e&&null==i&&$("#page-wrapper").css("min-height","700px"),e>i&&$("#page-wrapper").css("min-height",e+"px"),i>e&&$("#page-wrapper").css("min-height",s+"px"),i>e&&e>s&&$("#page-wrapper").css("min-height",i+"px"),e==i&&s>e&&$("#page-wrapper").css("min-height",s+"px")}$(window).bind("load resize scroll",function(){$("body").hasClass("body-small")||a()}),$(window).scroll(function(){$(window).scrollTop()>0&&!$("body").hasClass("fixed-nav")?$("#right-sidebar").addClass("sidebar-top"):$("#right-sidebar").removeClass("sidebar-top")}),setTimeout(function(){a()})}),$(function(){function a(){var a=$("#page-wrapper").height();a>1100&&$(".to-top").css("display","block")}$(window).bind("load resize",function(){$(this).width()<1e3&&$("body").addClass("mini-navbar"),$(this).width()<769?($("body").removeClass("mini-navbar"),$("body").addClass("body-small")):$("body").removeClass("body-small")}),$("html").click(function(){$(".search-span").hide(),$(".list-search-dropdown").hide()});var e={x:-1,y:-1};$(document).mousemove(function(i){e.x=i.pageX,e.y=i.pageY,i.pageY>800?a():i.pageY<700&&$(".to-top").css("display","none")})});
;function getData(){var t=window.location.href,e=t.split("?")[1];$.ajax({type:"POST",url:"/api/trends/product",data:"id="+e,success:function(t){syncDesc(t,"#sync-product")}})}function syncDesc(t,e){function a(t){var e=this.chart;Highcharts.each(Highcharts.charts,function(a){a!==e&&a.xAxis[0].setExtremes&&a.xAxis[0].setExtremes(t.min,t.max)})}$(e).bind("mousemove touchmove",function(t){var e,a,i;for(i=0;i<Highcharts.charts.length;i++)e=Highcharts.charts[i],t=e.pointer.normalize(t),a=e.series[0].searchPoint(t,!0),a&&(a.onMouseOver(),e.tooltip.refresh(a),e.xAxis[0].drawCrosshair(t,a))}),Highcharts.Pointer.prototype.reset=function(){},$.each(t.datasets,function(i,r){r.data=Highcharts.map(r.data,function(e,a){return[t.xData[a],e]});var s=!1;r.name.indexOf("Alexa")>0&&(s=!0),$('<div class="chart">').appendTo(e).highcharts({chart:{marginLeft:40,spacingTop:20,spacingBottom:20},title:{text:r.name,align:"left",margin:20,x:40,y:5},credits:{enabled:!1},legend:{layout:"vertical",align:"right",verticalAlign:"middle",borderWidth:0},xAxis:{crosshair:!0,events:{setExtremes:a},categories:t.xData},yAxis:{title:{text:""},offset:-10,reversed:s,min:0},tooltip:{positioner:function(){return{x:this.chart.chartWidth-this.label.width,y:-1}},borderWidth:0,backgroundColor:"none",pointFormat:"{point.y}",headerFormat:"",shadow:!1,style:{fontSize:"18px"},valueDecimals:r.valueDecimals},series:[{data:r.data,name:"-",type:r.type,color:Highcharts.getOptions().colors[i],fillOpacity:.3,tooltip:{valueSuffix:" "+r.unit}}]})})}
;!function(){angular.module("gobi",["ngCookies","ngTouch","ui.grid","ui.grid.selection","ui.grid.resizeColumns","ui.grid.infiniteScroll","frapontillo.bootstrap-switch","ui.router","oc.lazyLoad","ui.bootstrap","pascalprecht.translate"])}();
;function config(t,e,l,s){l.when("","/index"),l.otherwise("/index/home"),s.config({debug:!1}),t.interceptors.push(function(){return{request:function(t){return t},response:function(t){var e=t.data;return angular.isString(e)&&"login"==e&&(window.location.href="/login.html"),t}}}),e.state("index",{"abstract":!0,url:"/index",templateUrl:"views/common/content.html"}).state("company",{"abstract":!0,url:"/company",templateUrl:"views/company/company.html"}).state("list",{"abstract":!0,url:"/list",templateUrl:"views/list/list.html"}).state("follow",{"abstract":!0,url:"/follow",templateUrl:"views/follow/list.html"}).state("index.home",{url:"/home",templateUrl:"views/home.html",resolve:{loadPlugin:function(t){return t.load([{serie:!0,name:"angular-flot",files:["js/plugins/flot/jquery.flot.js","js/plugins/flot/jquery.flot.time.js","js/plugins/flot/jquery.flot.tooltip.min.js","js/plugins/flot/jquery.flot.spline.js","js/plugins/flot/jquery.flot.resize.js","js/plugins/flot/jquery.flot.pie.js","js/plugins/flot/curvedLines.js","js/plugins/flot/angular-flot.js"]},{name:"angles",files:["js/plugins/chartJs/angles.js","js/plugins/chartJs/Chart.min.js"]},{name:"angular-peity",files:["js/plugins/peity/jquery.peity.min.js","js/plugins/peity/angular-peity.js"]}])}}}).state("index.search",{url:"/search",templateUrl:"views/search.html"}).state("index.searches",{url:"/searches",templateUrl:"views/save_searches.html"}).state("index.myList",{url:"/my_list",templateUrl:"views/my_list.html"}).state("index.listSearch",{url:"/list_search",templateUrl:"views/list_search.html"}).state("index.news",{url:"/news",templateUrl:"views/news.html"}).state("index.th",{url:"/th",templateUrl:"views/th.html"}).state("company.overview",{url:"/overview",templateUrl:"views/company/overview.html"}).state("company.trends",{url:"/trends",templateUrl:"views/company/trends.html"}).state("company.team",{url:"/team",templateUrl:"views/company/team.html"}).state("company.events",{url:"/events",templateUrl:"views/company/events.html"}).state("list.data",{url:"/data",templateUrl:"views/list/data.html"}).state("list.trends",{url:"/trends",templateUrl:"views/list/trends.html"}).state("list.events",{url:"/events",templateUrl:"views/list/events.html"}).state("follow.data",{url:"/data",templateUrl:"views/follow/data.html"}).state("follow.trends",{url:"/trends",templateUrl:"views/follow/trends.html"}).state("follow.events",{url:"/events",templateUrl:"views/follow/events.html"})}angular.module("gobi").config(config).run(function(t,e){t.$state=e});
;function MainCtrl(t,e,n,i){var a=document.cookie.split(";"),l="";angular.forEach(a,function(t){0==t.trim().indexOf("username")&&(l=t.split("=")[1])}),this.userName=l;var s=i.get("ls_language");null!=s&&n.use(s);var o=i.get("ls_mini");null!=o&&$("body").addClass("mini-navbar"),e.logout=function(){var e=document.cookie.split(";");angular.forEach(e,function(t){var e=t.split("=");document.cookie=e[0]+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}),t.get("./api/user/logout").success(function(){window.location.href="/login.html"})}}function TranslateCtrl(t,e,n,i,a){e.changeLanguage=function(e){t.use(e),n.put("ls_language",e),(a.absUrl().indexOf("/search")>0||a.absUrl().indexOf("/follow/data")>0||a.absUrl().indexOf("/list/data")>0)&&a.absUrl().indexOf("/searches")<0&&i.location.reload()}}function HomeCtrl(t,e){e.get("./api/company/news/latest").success(function(e){t.newsList=e.newsList})}function SearchCtrl(t,e,n,i){e.saveSearch=function(){var t=i.get("ls_params"),e=angular.fromJson(t);if(e.page=1,t=angular.toJson(e),t.length<15)return void $(".operate-hint-danger").fadeIn(500).delay(2e3).fadeOut(500);$("#save-search").addClass("disabled");var a={method:"PUT",url:"./api/user/search/create",params:{params:t}};n(a).success(function(){$(".operate-hint").fadeIn(500).delay(2e3).fadeOut(500,function(){$("#save-search").removeClass("disabled")})}).error(function(){})}}function ModalCtrl(t,e,n,i,a,l,s){n.get("./api/common/searchBy").success(function(t){e.searchItems=t.searchBy,l.put("ls_funding_rounds",t.fundingRound)}),e.open=function(a){openModalFilter(t,e,n,i,l,s,a)},e.addMyList=function(){var t=angular.fromJson(l.get("ls_select_rows")),e=[];angular.forEach(t,function(t){e.push(t.companyId)});var i={method:"POST",url:"./api/company/addMyList",data:e};n(i).success(function(t){console.log(t)})}}function ModalInstanceCtrl(t,e,n){t.fundingRounds=n.get("ls_funding_rounds"),t.nameItems=n.get("ls_name"),t.keywordItems=n.get("ls_keyword"),t.locationItems=n.get("ls_location"),t.investorItems=n.get("ls_investor"),t.stageItems=n.get("ls_stage"),t.foundedAfter=n.get("ls_founded_after"),t.foundedBefore=n.get("ls_founded_before"),t.ok=function(){e.close()},t.cancel=function(){e.dismiss("cancel")},t.stageInit=function(e){if(null!=t.stageItems){var n=t.stageItems.indexOf(e);this.checked=-1==n?!1:!0}}}function GridCtrl(t,e,n,i,a,l,s,o,r,c){t.dataCount=0,e.mySelections=[];var d=function(t){var e=s.defer();return l(function(){e.resolve("col: "+t)},100,1),e.promise},u=$(window).height(),f=10,p=(u-240)/40;f=p>f?p:f,e.colDefs=[{field:"productName",name:c.instant("NAME"),width:"10%",minWidth:100,enableSorting:!1,enableHiding:!1,cellTemplate:'<div class="grid-name ui-grid-cell-contents"><a href="#/company/overview?{{row.entity.companyId}}">{{row.entity[col.field]}}</a></div>',menuItems:[{title:c.instant("NAME_FILTER"),icon:"ui-grid-icon-filter",action:function(){openModalFilter(t,e,n,i,o,r,"name")}}]},{field:"keywords",name:c.instant("KEYWORDS"),width:"12%",minWidth:100,enableSorting:!1,enableHiding:!1,menuItems:[{title:c.instant("KEYWORD_FILTER"),icon:"ui-grid-icon-filter",action:function(){openModalFilter(t,e,n,i,o,r,"keyword")}}]},{field:"companyDesc",name:c.instant("DESC"),width:"28%",minWidth:300,enableSorting:!1,cellTemplate:'<div class="grid-desc ui-grid-cell-contents tool">{{row.entity[col.field]}}</div>'},{field:"establishDate",name:c.instant("FOUNDED"),width:"8%",minWidth:80,cellTemplate:'<div class="grid-name ui-grid-cell-contents"><span ng-hide="row.entity.establishDate != null">N/A</span>  <span ng-show="row.entity.establishDate != null">{{row.entity.establishDate.slice(0,7)}}</span></div>'},{field:"stage",name:c.instant("STAGE"),width:"8%",minWidth:80},{field:"location",name:c.instant("LOCATION"),width:"8%",minWidth:80,enableHiding:!1,menuItems:[{title:c.instant("LOCATION_FILTER"),icon:"ui-grid-icon-filter",shown:!0}]},{field:"status",name:c.instant("STATUS"),width:"8%",minWidth:80},{field:"website",name:c.instant("WEBSITE"),minWidth:150,enableSorting:!1,cellTemplate:'<div class="grid-website ui-grid-cell-contents"><span ng-show="row.entity.website == null || row.entity.website.length == 0">N/A</span><a href="{{row.entity[col.field]}}" target="_blank" ng-show="row.entity.website != null">{{row.entity[col.field]}}</a></div>'}],e.gridOptions={headerRowHeight:50,rowHeight:40,minRowsToShow:f,exporterMenuCsv:!1,enableGridMenu:!0,enableRowSelection:!0,enableSelectAll:!0,infiniteScrollRowsFromEnd:20,infiniteScrollUp:!0,infiniteScrollDown:!0,gridMenuTitleFilter:d,columnDefs:e.colDefs,data:"data",onRegisterApi:function(n){e.gridApi=n,n.selection.on.rowSelectionChanged(e,function(){var e=[];angular.forEach(n.selection.getSelectedRows(),function(t){var e=t.companyId;this.push(e)},e),o.put("ls_select_rows",e),t.dataCount=n.grid.selection.selectedCount}),n.selection.on.rowSelectionChangedBatch(e,function(){var e=[];angular.forEach(n.selection.getSelectedRows(),function(t){var e=t.companyId;this.push(e)},e),o.put("ls_select_rows",e),t.dataCount=n.grid.selection.selectedCount}),n.infiniteScroll.on.needLoadMoreData(e,e.getDataDown),n.infiniteScroll.on.needLoadMoreDataTop(e,e.getDataUp)}},e.data=[],e.firstPage=1,e.lastPage=1,e.totalPage=10,o.put("ls_page",1),o.put("ls_change",!0),change(t,e,n,o,r),e.getDataDown=function(){if(!(r.getData().length<50)&&(e.page=o.get("ls_page"),10!=e.page)){o.put("ls_page",++e.page),o.put("ls_change",!0);var i=getParams(t,e,n,o,r),a=[],l={method:"POST",url:"/api/search/company",headers:{"Content-Type":"application/json"},data:i,responseType:"json"};n(l).success(function(e){t.total=e.total,a=e.companyIds}).then(function(){if(0!=a.length){var t=s.defer(),i={method:"POST",url:"./api/company/getCompanies",params:{ids:a}};n(i).success(function(n){console.log(a),e.lastPage++;var i=n.companyList;e.gridApi.infiniteScroll.saveScrollPercentage(),e.data=e.data.concat(i),e.gridApi.infiniteScroll.dataLoaded(e.firstPage>1,e.lastPage<e.totalPage).then(function(){t.resolve()})}).error(function(){e.gridApi.infiniteScroll.dataLoaded(),t.reject()})}})}},e.$watch(function(){return r.getData()},function(t,n){t!==n&&(e.gridApi.infiniteScroll.resetScroll(),e.data=r.getData())})}function KeywordSwitchCtrl(t,e){t.onText="AND",t.offText="OR",t.isActive=!0,t.size="mini",t.offColor="primary",t.animate=!0,t.radioOff=!0,e.get("ls_keyword_switch")&&(t.isSelected=!0),t.$watch("isSelected",function(n,i){n!==i&&(void 0!=t.isSelected&&null!=t.isSelected?e.put("ls_keyword_switch",t.isSelected):e.put("ls_keyword_switch",null),e.put("ls_change",!0))})}function InvestorSwitchCtrl(t,e){t.onText="AND",t.offText="OR",t.isActive=!0,t.size="mini",t.offColor="primary",t.animate=!0,t.radioOff=!0,e.get("ls_investor_switch")&&(t.isSelected=!0),t.$watch("isSelected",function(n,i){n!==i&&(void 0!=t.isSelected&&null!=t.isSelected?e.put("ls_investor_switch",t.isSelected):e.put("ls_investor_switch",null),e.put("ls_change",!0))})}function DatepickerCtrl(t,e){t.today=function(){t.dt=new Date};var n=e.get("ls_founded_after"),i=e.get("ls_founded_before");null==n?(t.dt="01/01/2012",e.put("ls_founded_after",t.dt),e.put("ls_change",!0)):t.dt=n,null!=i&&(t.dt2=i),t.clear=function(){t.dt=null},t.open=function(e,n){e.preventDefault(),e.stopPropagation(),1==n?(t.order1opened=!0,t.order2opened=!1):(t.order1opened=!1,t.order2opened=!0)},t.dateOptions={formatYear:"yy",startingDay:1},t.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","MM/dd/yyyy"],t.format=t.formats[3]}function CompanyHeadCtrl(t,e,n,i,a){var l=a.absUrl().split("?")[1];(null==l||""==l)&&a.path("/"),n.get("/api/trends/exist?id="+l).success(function(t){e.trends=t}),n.get("./api/company/head?id="+l).success(function(t){e.headInfo=t.headInfo}).error(function(){a.path("/")}),e.$watch(function(){return a.absUrl()},function(t,e){t!==e&&(t.indexOf("overview")>-1?$("#li-overview").addClass("cate-active").siblings().removeClass("cate-active"):t.indexOf("trends")>-1?$("#li-trends").addClass("cate-active").siblings().removeClass("cate-active"):t.indexOf("events")>-1&&$("#li-events").addClass("cate-active").siblings().removeClass("cate-active"))})}function CompanyOverviewCtrl(t,e,n,i,a,l){var s=a.absUrl().split("?")[1];(null==s||""==s)&&a.path("/"),n.get("./api/company/overview?id="+s).success(function(t){e.company=t.company,console.log(t),e.descAll=t.company.companyDesc.split(/\r?\n/);var n=0,i=[],a=!1;angular.forEach(e.descAll,function(t){!a&&800>n&&i.length<10?(n+=t.length,""!=t&&i.push(t)):a=!0,e.desc=i,e.descMore=a})}).error(function(){a.path("/")}).then(function(){n.get("./api/company/lagou/info?id="+s).success(function(t){var n=t.lagouInfo;if(null!=n){var i=n.logo;-1==i.indexOf("lagou")&&(i="/file/"+i+"/logo.png"),e.logo=i,e.headCount=n.headCountName}}),n.get("./api/user/list/getFeature?companyId="+s).success(function(t){e.userList=t.userList}),n.get("./api/user/list/getExsiting?companyId="+s).success(function(t){e.exsitingList=t.exsitingList}).error(function(){a.path("/")})}),e.more=function(){e.desc=e.descAll,e.descMore=!1},e.saveNote=function(){var t=$("#company-note").val();if(null!=e.company.userCompanyRel){var i=e.company.userCompanyRel.note;if(t==i)return}else if(""==t||null==t)return;var a={method:"put",url:"./api/user/company/updateNote",params:{companyId:s,note:t}};n(a).success(function(){e.company.userCompanyRel.note=t}).then(function(){$(".heart").addClass("fa-heart"),$(".heart").removeClass("fa-heart-o"),alertDiv(l.instant("SAVED"),l.instant("UPDATE_NOTE_SUCCESS"))})}}function CompanyEventsCtrl(t,e,n,i,a){var l=a.absUrl().split("?")[1];(null==l||""==l)&&a.path("/"),n.get("./api/company/news/companyNews?id="+l).success(function(t){e.newsList=t.newsList}).error(function(){a.path("/")})}function BasicModalCtrl(t,e,n,i,a,l,s,o){e.open=function(t){if("profile"==t&&n.get("./api/user/profile").success(function(t){e.profile=t.profile,a.put("ls_profile",e.profile)}),"list"==t){var r=l.absUrl().split("?")[1];if(l.absUrl().split("?")[0].indexOf("company")>0&&null!=r&&""!=r){var c=[];c.push(r),a.put("ls_select_rows",c)}var d=a.get("ls_select_rows");null==d&&(d=a.get("ls_company"),a.put("ls_select_rows",d)),a.remove("ls_add_list")}var u=i.open({templateUrl:"./views/modal/user/"+t+"_modal.html",controller:"BasicModalInstanceCtrl",resolve:{template:function(){return t}}});u.result.then(function(i){if("create_list"==t){if(null==i.listName||""==i.listName)return;var a={method:"put",url:"./api/user/list/create",params:{name:i.listName}};n(a).success(function(){}).then(function(){n.get("./api/user/list/get?page=1").success(function(t){e.page=1,e.userList=t.userList,e.total=t.total,o.newData(t.userList)}),alertDiv(s.instant("SAVED"),s.instant("CREATE_NEW_LIST_SUCCESS"))})}if("list"==t){var a={method:"put",url:"./api/company/list/add",params:{listIds:i.list,companyIds:i.companyIds}};n(a).success(function(){}).then(function(){alertDiv(s.instant("SAVED"),s.instant("ADD_TO_SELECTED_LIST"))})}})}}function BasicModalInstanceCtrl(t,e,n,i){t.callBack={},"profile"==i&&(t.profile=n.get("ls_profile")),t.ok=function(){"create_list"==i&&(t.callBack.listName=$("#list-name").val()),"comfirm"==i&&(t.callBack.comfirm=!0),e.close(t.callBack)},t.addConfirm=function(){var i=n.get("ls_add_list");return null==i||0==i.length?void $(".select-list").css("display","block"):(t.callBack.list=i,t.callBack.companyIds=n.get("ls_select_rows"),void e.close(t.callBack))},t.cancel=function(){e.dismiss("cancel")}}function EditModalCtrl(t,e,n,i,a,l){e.open=function(e,a){var s=i.open({templateUrl:"./views/modal/user/"+e+"_modal.html",controller:"EditModalInstanceCtrl",resolve:{template:function(){return e},info:function(){return a}}});s.result.then(function(i){if("edit_list"==e){if(null==i.listName||""==i.listName)return;n.get("./api/user/list/getById?id="+i.listId).success(function(e){if(e.list.listName!=i.listName||e.list.listDesc!=i.listDesc||e.list.listStatus!=i.listStatus){var a={method:"put",url:"./api/user/list/update",params:{name:i.listName,desc:i.listDesc,listStatus:i.listStatus,id:i.listId}};n(a).success(function(){}).then(function(){n.get("./api/user/list/get?start=0").success(function(e){t.userList=e.userList}).then(function(){alertDiv(l.instant("SAVED"),l.instant("UPDATE_LIST_SUCCESS"))})})}})}})}}function EditModalInstanceCtrl(t,e,n,i,a,l){if(t.callBack={},"edit_list"==a){var s=angular.fromJson(l),o={method:"get",url:"./api/user/list/getById",params:{id:s.listId}};e(o).success(function(e){t.editList=e.list})}t.ok=function(){"edit_list"==a&&(t.callBack.listName=$("input[name=listName]").val(),t.callBack.listDesc=$("input[name=listDesc]").val(),t.callBack.listStatus=$("input[name=listStatus]:checked").val(),t.callBack.listId=t.editList.listId),n.close(t.callBack)},t.cancel=function(){n.dismiss("cancel")}}function SaveSearchCtrl(t,e,n){t.page=1,e.get("./api/user/search/get?page=1").success(function(e){t.total=e.total;var i=[];angular.forEach(e.searchList,function(t){var e={};e=t,parseSearchParams(n,e),this.push(e)},i),t.searchList=i})}function ListCtrl(t,e,n,i){e.page=1,n.get("./api/user/list/get?page=1").success(function(t){e.userList=t.userList,e.heartList=t.heartList,e.total=t.total,i.newData(t.userList)}),e.$watch(function(){return i.getData()},function(t,n){t!==n&&(e.userList=t)})}function ListDetailCtrl(t,e,n,i,a,l,s,o){var r=a.absUrl().split("?")[1];(null==r||""==r)&&a.path("/index/my_list"),n.get("./api/user/list/overview?id="+r).success(function(n){e.listInfo=n.listInfo,e.companyList=n.companyList,t.total=n.companyList.length,s.newData(e.companyList)}).error(function(){a.path("/index/my_list")}),e.share=function(){var t=e.listInfo.listStatus,i={method:"put",url:"./api/user/list/updateStatus",params:{id:r,status:t}};n(i).success(function(){}).then(function(){1001==t?(e.listInfo.listStatus=1002,alertDiv(o.instant("SAVED"),o.instant("SHARE_SUCCESS"))):(e.listInfo.listStatus=1001,alertDiv(o.instant("SAVED"),o.instant("CLOSE_SHARE_SUCCESS")))})},e.deleteSelected=function(){var a=comfirm(i);a.result.then(function(i){if(i.comfirm){var a=l.get("ls_select_rows"),c={method:"delete",url:"./api/company/list/delete",params:{listId:e.listInfo.listId,ids:a}};n(c).success(function(){n.get("./api/user/list/overview?id="+r).success(function(n){e.listInfo=n.listInfo,e.companyList=n.companyList,t.total=n.companyList.length,s.newData(e.companyList),t.listSelectedCount=0})}).then(function(){alertDeleteDiv(o.instant("DELETED"),o.instant("DELETE_FROM_LIST"))})}})}}function ListModalCtrl(t,e,n,i){getAllList(t,e,n,i),t.createButton=function(){$("#hide-create-list").show(),$("#div-create-list").show(),$("#a-create-list").hide()},t.hideButton=function(){$("#hide-create-list").hide(),$("#div-create-list").hide(),$("#a-create-list").show()}}function FollowCtrl(t,e,n,i,a,l,s){n.get("./api/user/company/getDetail").success(function(n){e.companyList=n.companyList,t.total=n.companyList.length,l.newData(e.companyList)}),e.deleteSelected=function(){var o=comfirm(i);o.result.then(function(i){if(i.comfirm){var o=a.get("ls_select_rows"),r={method:"delete",url:"./api/user/company/unfollow",params:{ids:o}};n(r).success(function(){n.get("./api/user/company/getDetail").success(function(n){e.companyList=n.companyList,t.total=n.companyList.length,l.newData(e.companyList),t.listSelectedCount=0})}).then(function(){alertDeleteDiv(s.instant("DELETED"),s.instant("DELETE_FROM_LIST"))})}})}}function ListGridCtrl(t,e,n,i,a,l,s,o,r,c){t.listSelectedCount=0;var d=function(t){var e=s.defer();return l(function(){e.resolve("col: "+t)},100,1),e.promise},u=$(window).height(),f=10,p=(u-240)/40;f=p>f?p:f,e.colDefs=[{field:"productName",name:c.instant("NAME"),width:"10%",minWidth:100,enableSorting:!1,enableHiding:!1,cellTemplate:'<div class="grid-name ui-grid-cell-contents"><a href="#/company/overview?{{row.entity.companyId}}">{{row.entity[col.field]}}</a></div>'},{field:"keywords",name:c.instant("KEYWORDS"),width:"12%",minWidth:100,enableSorting:!1,enableHiding:!1},{field:"companyDesc",name:c.instant("DESC"),width:"28%",minWidth:300,enableSorting:!1,cellTemplate:'<div class="grid-desc ui-grid-cell-contents tool">{{row.entity[col.field]}}</div>'},{field:"establishDate",name:c.instant("FOUNDED"),width:"8%",minWidth:80,cellTemplate:'<div class="grid-name ui-grid-cell-contents"><span ng-hide="row.entity.establishDate != null">N/A</span>  <span ng-show="row.entity.establishDate != null">{{row.entity.establishDate.slice(0,7)}}</span></div>'},{field:"stage",name:c.instant("STAGE"),width:"8%",minWidth:80},{field:"location",name:c.instant("LOCATION"),width:"8%",minWidth:80,enableHiding:!1},{field:"status",name:c.instant("STATUS"),width:"8%",minWidth:80},{field:"website",name:c.instant("WEBSITE"),minWidth:150,enableSorting:!1,cellTemplate:'<div class="grid-website ui-grid-cell-contents"><span ng-show="row.entity.website == null || row.entity.website.length == 0">N/A</span><a href="{{row.entity[col.field]}}" target="_blank" ng-show="row.entity.website != null">{{row.entity[col.field]}}</a></div>'}],e.gridOptions={headerRowHeight:50,rowHeight:40,minRowsToShow:f,exporterMenuCsv:!1,enableGridMenu:!0,enableRowSelection:!0,enableSelectAll:!0,infiniteScrollRowsFromEnd:20,infiniteScrollUp:!0,infiniteScrollDown:!0,gridMenuTitleFilter:d,columnDefs:e.colDefs,data:"data",onRegisterApi:function(n){e.gridApi=n,n.selection.on.rowSelectionChanged(e,function(){var e=[];angular.forEach(n.selection.getSelectedRows(),function(t){var e=t.companyId;this.push(e)},e),o.put("ls_select_rows",e),t.listSelectedCount=n.grid.selection.selectedCount}),n.selection.on.rowSelectionChangedBatch(e,function(){var e=[];angular.forEach(n.selection.getSelectedRows(),function(t){var e=t.companyId;this.push(e)},e),o.put("ls_select_rows",e),t.listSelectedCount=n.grid.selection.selectedCount})}},e.data=[],e.data=r.getData(),t.total=e.data.length,e.$watch(function(){return r.getData()},function(t,n){t!==n&&(e.gridApi.infiniteScroll.resetScroll(),e.data=r.getData())}),e.$watch(function(){return t.listSelectedCount},function(n,i){n!==i&&(e.gridApi.grid.selection.selectedCount=t.listSelectedCount)})}function NewsCtrl(t,e,n){var i=n.absUrl().split("?")[1];(null==i||""==i)&&n.path("/"),e.get("./api/company/news/get?id="+i).success(function(e){t.news=e.news,console.log(e)}).error(function(){n.path("/")})}function ThCtrl(t,e,n,i,a){n.remove("th_special"),n.remove("th_using"),n.remove("th_wastes"),t.currentPage=n.get("currentPage"),null==t.currentPage&&(t.currentPage=1),t.maxSize=10,t.bigTotalItems=1e3,e.get("./api/thesaurus/get?page="+t.currentPage).success(function(e){t.list=e.list,t.total=e.total});n.get("th_special"),n.get("th_using"),n.get("th_waste");t.setPage=function(e){t.currentPage=e},t.pageChanged=function(){n.put("currentPage",t.currentPage),i.location.reload()},t.update=function(){var t=n.get("th_special");if(console.log(t),null!=t&&void 0!=t&&t.length>0){var l={method:"PUT",url:"./api/thesaurus/update",params:{ids:t,type:1101}};e(l).success(function(){i.location.href="#/index/th",n.remove("th_special"),alertDiv(a.instant("SAVED"),a.instant("Specail.."))})}var s=n.get("th_using");if(console.log(s),null!=s&&void 0!=s&&s.length>0){var l={method:"PUT",url:"./api/thesaurus/update",params:{ids:s,type:1102}};e(l).success(function(){i.location.href="#/index/th",n.remove("th_using"),alertDiv(a.instant("SAVED"),a.instant("Using.."))})}var o=n.get("th_waste");if(console.log(o),null!=o&&void 0!=o&&o.length>0){var l={method:"PUT",url:"./api/thesaurus/update",params:{ids:o,type:1103}};e(l).success(function(){i.location.href="#/index/th",n.remove("th_waste"),alertDiv(a.instant("SAVED"),a.instant("Waste.."))})}}}angular.module("gobi").controller("MainCtrl",MainCtrl).controller("TranslateCtrl",TranslateCtrl).controller("HomeCtrl",HomeCtrl).controller("SearchCtrl",SearchCtrl).controller("ModalCtrl",ModalCtrl).controller("ModalInstanceCtrl",ModalInstanceCtrl).controller("GridCtrl",GridCtrl).controller("KeywordSwitchCtrl",KeywordSwitchCtrl).controller("InvestorSwitchCtrl",InvestorSwitchCtrl).controller("DatepickerCtrl",DatepickerCtrl).controller("CompanyHeadCtrl",CompanyHeadCtrl).controller("CompanyOverviewCtrl",CompanyOverviewCtrl).controller("CompanyEventsCtrl",CompanyEventsCtrl).controller("BasicModalCtrl",BasicModalCtrl).controller("BasicModalInstanceCtrl",BasicModalInstanceCtrl).controller("EditModalCtrl",EditModalCtrl).controller("EditModalInstanceCtrl",EditModalInstanceCtrl).controller("SaveSearchCtrl",SaveSearchCtrl).controller("ListCtrl",ListCtrl).controller("ListDetailCtrl",ListDetailCtrl).controller("ListModalCtrl",ListModalCtrl).controller("FollowCtrl",FollowCtrl).controller("ListGridCtrl",ListGridCtrl).controller("NewsCtrl",NewsCtrl).controller("ThCtrl",ThCtrl);
;function sideNavigation(e){return{restrict:"A",link:function(t,i){e(function(){i.metisMenu()})}}}function minimalizaSidebar(e,t){return{restrict:"A",template:'<a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="" ng-click="minimalize()"><i class="fa fa-bars"></i></a>',controller:function(e){e.minimalize=function(){$("body").toggleClass("mini-navbar"),!$("body").hasClass("mini-navbar")||$("body").hasClass("body-small")?($("#side-menu").hide(),setTimeout(function(){$("#side-menu").fadeIn(500)},100),t.remove("ls_mini")):$("body").hasClass("fixed-sidebar")?($("#side-menu").hide(),setTimeout(function(){$("#side-menu").fadeIn(500)},300)):($("#side-menu").removeAttr("style"),t.put("ls_mini","mini"))}}}}function filter(e,t,i,n,r,s,a){return{restrict:"AE",require:"ngModel",transclude:!0,link:function(i,l,c){l.bind("keyup",function(o){var u=c.ngModel;if(32!=o.which){if(38===o.which)return void keyUpOrDown(l,"up");if(40===o.which)return void keyUpOrDown(l,"down");l.next().css("display","block");var d=l.val();if(""!=d&&null!=d){var u=c.ngModel,f="/api/search/"+u,h={method:"POST",url:f,data:d};t(h).success(function(e){if(i.ajaxKeywordItems=e.tags,i.ajaxInvestorItems=e.investors,i.ajaxLocationItems=e.locations,i.ajaxNameItems=e.names,"full"==u){var t={},n=[],r=[];e.tags.length>0?n.push(e.tags[0]):n=null,e.investors.length>0?r.push(e.investors[0]):r=null,t.tags=n,t.investors=r,t.names=e.names,i.ajaxFullItems=t}}).error(function(){}),13===o.which&&(i.$apply(function(){var c=l.val();if(void 0!=c&&null!=c&&""!=c){if("full"==u)return u="name",c.indexOf("in investor")>0?(u="investor",c=c.slice(0,c.length-13)):c.indexOf("in keyword")>0&&(u="keyword",c=c.slice(0,c.length-12)),doSearch(e,i,t,n,s,a,c,u),void l.next().css("display","none");var o=parseAndStorage(u,c,s);if("keyword"==u&&(i.keyword=""),"location"==u&&(i.location=""),"investor"==u&&(i.investor=""),"name"==u&&(i.name=""),!o){var d=r(appendElement(u,c))(i);l.parent().children("span").first().append(d),s.put("ls_change",!0),l.next().css("display","none"),$("#div-"+u).is(":visible")||$("#div-"+u).css("display","inline-block"),"keyword"==u&&t.get("./api/tag/rel/get?name="+c).success(function(t){t.tags.length>0?(e.relItems=t.tags,$(".tag-rel").show()):$(".tag-rel").hide()})}}}),o.preventDefault())}}}),l.bind("click",function(e){"full"==c.ngModel&&$(".search-span").show(),e.stopPropagation()}),l.bind("focusout",function(){})}}}function closeFilter(e,t,i,n){return{restrict:"AE",link:function(r,s,a){s.bind("click",function(){s.parent().hide();var l=a.closeFilter;i.remove("ls_"+a.closeFilter),"stage"==l&&i.remove("ls_stage_value"),"founded"==l&&(i.remove("ls_founded_after"),i.remove("ls_founded_before")),i.put("ls_change",!0),i.put("ls_page",1),change(e,r,t,i,n)})}}}function itemCloseFilter(e,t){return{restrict:"AE",link:function(e,i,n){i.bind("click",function(){i.parent().remove();for(var e=(n.itemCloseFilter,"ls_"+n.itemCloseFilter),r=t.get(e),s=i.parent().text().trim(),a=r.length;a--;)r[a]===s&&r.splice(a,1);0==r.length?t.remove(e):t.put(e,r),t.put("ls_change",!0)})}}}function stageFilter(e){return{restrict:"A",link:function(t,i,n){i.bind("click",function(){var t=i.context.checked,r=[],s=[],a=e.get("ls_stage"),l=e.get("ls_stage_value");null!=a&&(r=a),null!=l&&(s=l);var c=n.ngValue,o=n.stageFilter;if(t)r.push(c),s.push(o);else{for(var u=r.length;u--;)r[u]===c&&r.splice(u,1);for(var u=s.length;u--;)s[u]===o&&s.splice(u,1)}0==r.length?e.remove("ls_stage"):e.put("ls_stage",r),0==s.length?e.remove("ls_stage_value"):e.put("ls_stage_value",s),e.put("ls_change",!0)})}}}function foundedFilter(e){return{restrict:"A",link:function(t,i,n){i.bind("focusout",function(){var t=n.foundedFilter,r=i.val();"after"==t?e.put("ls_founded_after",r):e.put("ls_founded_before",r),e.put("ls_change",!0)})}}}function search(e,t,i,n,r,s){return{restrict:"A",link:function(r,a,l){a.bind("click",function(){var c=a.children("span").first().text().trim();void 0!=c&&null!=c&&""!=c&&(doSearch(e,r,i,n,t,s,c,l.search),a.parent().css("display","none"))})}}}function searchKeyword(e,t,i,n,r){return{restrict:"A",link:function(s,a){a.bind("click",function(){var l=a.text().trim();void 0!=l&&null!=l&&""!=l&&doSearch(e,s,t,i,n,r,l,"keyword")})}}}function searchInvestor(e,t,i,n,r){return{restrict:"A",link:function(s,a){a.bind("click",function(){var l=a.text().trim();void 0!=l&&null!=l&&""!=l&&doSearch(e,s,t,i,n,r,l,"investor")})}}}function nameAutoComplete(e,t,i,n){return{restrict:"A",link:function(e,i){i.bind("click",function(){autoComplete(e,i,"name",t,n)})}}}function keywordAutoComplete(e,t,i,n){return{restrict:"A",link:function(r,s){s.bind("click",function(){autoComplete(r,s,"keyword",t,n);var a=s.text().trim();i.get("./api/tag/rel/get?name="+a).success(function(t){t.tags.length>0?(e.relItems=t.tags,$(".tag-rel").show()):$(".tag-rel").hide()})})}}}function investorAutoComplete(e,t){return{restrict:"A",link:function(i,n){n.bind("click",function(){autoComplete(i,n,"investor",e,t)})}}}function locationAutoComplete(e,t){return{restrict:"A",link:function(i,n){n.bind("click",function(){autoComplete(i,n,"location",e,t)})}}}function categoryFilter(){return{restrict:"A",link:function(e,t){t.bind("click",function(){t.parent().addClass("cate-active"),t.parent().siblings().removeClass("cate-active")})}}}function deleteSavedSearch(e){return{restrict:"A",link:function(t,i,n){i.bind("click",function(){deleteOperation(e,i,"delete",n.deleteSavedSearch)})}}}function deleteOwner(e,t){return{restrict:"A",link:function(i,n,r){n.bind("click",function(){var i=comfirm(t);i.result.then(function(t){t.comfirm&&deleteOperation(e,n,"deleteOwner",r.deleteOwner)})})}}}function loadMoreData(e,t,i){return{restrict:"A",link:function(e,n,r){n.bind("click",function(){var n=r.loadMoreData,s="";"search"==n&&(s="./api/user/search/get",e.page=e.searchList.length/20),"list"==n&&(s="./api/user/list/get",e.page=e.userList.length/20);var a={method:"get",url:s,params:{page:++e.page}};t(a).success(function(t){e.total=t.total;var r=[];"search"==n&&(angular.forEach(t.searchList,function(e){var t={};t=e,parseSearchParams(i,t),this.push(t)},r),r=t.searchList,e.searchList=e.searchList.concat(r)),"list"==n&&(e.userList=e.userList.concat(t.userList))})})}}}function loadMoreList(){return{restrict:"A",link:function(e,t){t.bind("click",function(){var t=[],i=e.userList.length/20;angular.forEach(e.allList,function(e,t){t>=20*i&&20*(i+1)>t&&this.push(e)},t),e.userList=e.userList.concat(t)})}}}function selectList(e){return{restrict:"A",link:function(t,i,n){i.bind("click",function(){var t=n.selectList;$(".div-tag").removeClass("bg-selected"),i.addClass("bg-selected");var r=[];r.push(t),e.put("ls_add_list",r)})}}}function listDesc(e){return{restrict:"A",link:function(t,i,n){i.bind("focusout",function(){var t=angular.fromJson(n.listDesc),r=t.listDesc,s=i.val();if(r!=s){var a={method:"put",url:"./api/user/list/updateDesc",params:{desc:s,id:t.listId}};e(a).success(function(){})}})}}}function companyHeart(e,t){return{restrict:"A",link:function(i,n,r){n.bind("click",function(){var i=r.companyHeart;if(n.hasClass("fa-heart")){var s=comfirm(t);s.result.then(function(t){if(t.comfirm){var r={method:"put",url:"./api/user/company/updateHeart",params:{companyId:i,heart:"N"}};e(r).success(function(){}).then(function(){n.removeClass("fa-heart"),n.addClass("fa-heart-o")})}})}else{var a={method:"put",url:"./api/user/company/updateHeart",params:{companyId:i,heart:"Y"}};e(a).success(function(){}).then(function(){n.removeClass("fa-heart-o"),n.addClass("fa-heart")})}})}}}function newSearch(e,t,i){return{restrict:"A",link:function(n,r,s){r.bind("click",function(){var n=s.newSearch;t.get("./api/user/search/getById?id="+n).success(function(t){var i=angular.fromJson(t.search.searchParams);e.put("ls_name",null==i.names?null:i.names),e.put("ls_keyword",null==i.keywords?null:i.keywords),e.put("ls_keyword_switch",null==i.keywordSwitch?null:i.keywordSwitch),e.put("ls_location",null==i.locations?null:i.locations),e.put("ls_investor",null==i.investors?null:i.investors),e.put("ls_investor_switch",null==i.investorSwitch?null:i.investorSwitch),e.put("ls_stage",null==i.stages?null:i.stages),e.put("ls_founded_after",null==i.foundedAfter?null:i.foundedAfter),e.put("ls_founded_before",null==i.foundedBefore?null:i.foundedBefore)}).then(function(){i.path("/index/search")})})}}}function similarAddList(e,t,i,n){return{restrict:"A",link:function(r,s,a){s.bind("click",function(){var r=[];r.push(a.similarAddList),i.put("ls_select_rows",r),i.remove("ls_add_list");var s=t.open({templateUrl:"./views/modal/user/list_modal.html",controller:"BasicModalInstanceCtrl",resolve:{template:function(){return"list"}}});s.result.then(function(t){console.log(t.list);var i={method:"put",url:"./api/company/list/add",params:{listIds:t.list,companyIds:t.companyIds}};e(i).success(function(){}).then(function(){alertDiv(n.instant("SAVED"),n.instant("ADD_TO_SELECTED_LIST"))})})})}}}function selectRow(){return{restrict:"A",link:function(e,t){t.bind("mouseenter",function(){e.$apply(function(){t.addClass("bg-selected-row"),t.siblings().removeClass("bg-selected-row")})}),t.bind("mouseleave",function(){e.$apply(function(){t.removeClass("bg-selected-row")})})}}}function createList(e,t,i,n,r){return{restrict:"A",link:function(t,s){s.bind("click",function(){var s=$("#list-name").val().trim();if(null==s||""==s)return void $("#list-name").focus();var a={method:"put",url:"./api/user/list/create",params:{name:s}};e(a).success(function(){}).then(function(){getAllList(t,e,i,n),$("#hide-create-list").hide(),$("#div-create-list").hide(),$("#a-create-list").show(),alertDiv(r.instant("SAVED"),r.instant("CREATE_NEW_LIST_SUCCESS"))})})}}}function addList(e,t,i,n){return{restrict:"A",link:function(r,s){s.bind("click",function(){i.put("ls_feature",!0);var r=t.open({templateUrl:"./views/modal/user/list_modal.html",controller:"BasicModalInstanceCtrl",resolve:{template:function(){return"list"}}});r.result.then(function(t){var i={method:"put",url:"./api/company/list/add",params:{listIds:t.list,companyIds:t.companyIds}};e(i).success(function(){}).then(function(){alertDiv(n.instant("SAVED"),n.instant("ADD_TO_SELECTED_LIST"))})})})}}}function listFilter(e,t,i,n,r){return{restrict:"A",transclude:!0,link:function(e,i){i.bind("keyup",function(n){var s="";if(32!=n.which){if(38===n.which)return s=keyUpOrDown(i,"up"),void i.val(s.children().first().text().trim());if(40===n.which)return s=keyUpOrDown(i,"down"),void i.val(s.children().first().text().trim());var a=i.val().trim();""!=a&&null!=a&&(e.searchList=[],t.get("./api/user/list/search").success(function(){var t=0;angular.forEach(e.allList,function(e){angular.lowercase(e.listName).indexOf(angular.lowercase(a))>-1&&8>t&&(this.push(e),t++)},e.searchList)}),$(".list-search-dropdown").css("display","block"),13===n.which&&(e.$apply(function(){var t=i.val();if(null!=t&&""!=t){var n=$(".list-search-dropdown").children(),a=!1;if(n.each(function(){$(this).hasClass("result-select")&&(s=$(this),a=!0)}),$(".list-search-result").children().remove(),a){var l=s.children("input").val(),c={};angular.forEach(e.allList,function(e){e.listId==l&&(c=e)});var o=r(appendListSearch(c))(e);$(".list-search-result").append(o)}else{var u=[],d=0;angular.forEach(e.allList,function(i){if(i.listName.indexOf(t)>-1&&8>d){var n=r(appendListSearch(i))(e);$(".list-search-result").append(n),this.push(i),d++}},u)}$(".list-search-dropdown").css("display","none")}}),n.preventDefault()))}}),i.bind("click",function(e){var t=i.val().trim();""!=t&&null!=t&&($(".list-search-dropdown").show(),e.stopPropagation())})}}}function listAutoComplete(e){return{restrict:"A",link:function(t,i,n){i.bind("click",function(){var i=n.listAutoComplete,r={};angular.forEach(t.allList,function(e){e.listId==i&&(r=e)});var s=e(appendListSearch(r))(t);$(".list-search-result").append(s),$(".list-search-dropdown").css("display","none")})}}}function navHref(e){return{restrict:"A",link:function(t,i,n){i.bind("click",function(){var t,i=n.navHref;"home"==i?(t=$("#li-home"),e.location.href="#/index/home"):"search"==i?(t=$("#li-search"),e.location.href="#/index/search"):"searches"==i?(t=$("#li-searches"),e.location.href="#/index/searches"):"list"==i&&(t=$("#li-list"),e.location.href="#/index/my_list"),null!=t&&(t.addClass("active"),t.siblings().removeClass("active"))})}}}function toTop(){return{restrict:"A",link:function(e,t){t.bind("click",function(){$(document.body).animate({scrollTop:0},100)})}}}function companyPopover(){return{restrict:"A",link:function(e,t){t.bind("mouseenter",function(){t.next().show()}),t.bind("mouseleave",function(){t.next().hide()}),t.next().bind("mouseenter",function(){t.next().show()}),t.next().bind("mouseleave",function(){t.next().hide()})}}}function thSelect(e){return{restrict:"A",link:function(t,i,n){i.bind("click",function(){var t=n.thSelect;if(i.hasClass("bg-default")){var r=e.get("th_special");null==r&&(r=[]),r.push(t),i.addClass("bg-special"),i.removeClass("bg-default"),e.put("th_special",r)}else if(i.hasClass("bg-special")){var s=e.get("th_using");null==s&&(s=[]),s.push(t),i.addClass("bg-using"),i.removeClass("bg-special"),e.put("th_using",s);for(var r=e.get("th_special"),a=r.length;a--;)r[a]===t&&r.splice(a,1);e.put("th_special",r)}else if(i.hasClass("bg-using")){var l=e.get("th_waste");null==l&&(l=[]),l.push(t),i.addClass("bg-waste"),i.removeClass("bg-using"),e.put("th_waste",l);for(var s=e.get("th_using"),a=s.length;a--;)s[a]===t&&s.splice(a,1);e.put("th_using",s)}else if(i.hasClass("bg-waste")){i.addClass("bg-default"),i.removeClass("bg-waste");for(var l=e.get("th_waste"),a=l.length;a--;)l[a]===t&&l.splice(a,1);e.put("th_waste",l)}})}}}angular.module("gobi").directive("sideNavigation",sideNavigation).directive("minimalizaSidebar",minimalizaSidebar).directive("filter",filter).directive("closeFilter",closeFilter).directive("itemCloseFilter",itemCloseFilter).directive("stageFilter",stageFilter).directive("foundedFilter",foundedFilter).directive("search",search).directive("searchKeyword",searchKeyword).directive("searchInvestor",searchInvestor).directive("nameAutoComplete",nameAutoComplete).directive("keywordAutoComplete",keywordAutoComplete).directive("investorAutoComplete",investorAutoComplete).directive("locationAutoComplete",locationAutoComplete).directive("categoryFilter",categoryFilter).directive("deleteSavedSearch",deleteSavedSearch).directive("deleteOwner",deleteOwner).directive("loadMoreData",loadMoreData).directive("loadMoreList",loadMoreList).directive("selectList",selectList).directive("listDesc",listDesc).directive("companyHeart",companyHeart).directive("newSearch",newSearch).directive("similarAddList",similarAddList).directive("selectRow",selectRow).directive("createList",createList).directive("addList",addList).directive("listFilter",listFilter).directive("listAutoComplete",listAutoComplete).directive("navHref",navHref).directive("toTop",toTop).directive("companyPopover",companyPopover).directive("thSelect",thSelect);
;function gridService(){var e=[],n=function(n){e=n},r=function(n){n.concat(e)},i=function(){return e};return{newData:n,addData:r,getData:i}}function listGridService(){var e=[],n=function(n){e=n},r=function(){return e};return{newData:n,getData:r}}function listService(){var e=[],n=function(n){e=n},r=function(){return e};return{newData:n,getData:r}}function langService(){var e={},n=function(n){e=n},r=function(){return e};return{newData:n,getData:r}}angular.module("gobi").service("gridService",gridService).service("listGridService",listGridService).service("listService",listService).service("langService",langService);
;function config(E){E.translations("en",{LANGUAGE:"语言",SEARCH:"Search",LOGOUT:"Sign out",HOME:"Home",COMPANY_SEARCH:"Company Search",SAVED_SEARCHES:"Saved Searches",MY_LIST:"My List",LIST_SEARCH:"List Search",WELCOME:"Welcome",MESSAGEINFO:"MessageInfo",MENU:"Menu",PROFILE:"Profile",WELCOME_DESC:"Here are some great ways to get started",SEARCH_DESC:"Search companies by filter rules",SEARCHES_DESC:"Save your search info",LIST_DESC:"Add companies to your list",FOLLOWING_DESC:"Record your following companies",LATEST_EVENTS:"Latest events",READ_MORE:"Read More",MORE:"More",SEARCHBY:"Search by",KEYWORD:"Keyword",LOCATION:"Location",INVESTOR:"Investor",STAGE:"Stage",FINANCE:"Finance",FOUNDED:"Founded",STATUS:"Status",DATA:"Data",EVENTS:"Events",COMPANY:"Company",COMPANIES:"Companies",SAVE_SEARCH:"Save Search",FILTER:"Filter",AFTER:"after",BEFORE:"before",STATE:"State",COUNTRY:"Country",INVESTORS:"Investors",RELATION:"relationship",NAME:"Name",TAG_HINT:"You may also want to include",ADD_FILTER:"Please add filter rule",SAVE_SEARCH_SUCCESS:"Saved search successfully",NAME_FILTER:"Name filter",KEYWORD_FILTER:"Keyword filter",LOCATION_FILTER:"Location filter",KEYWORDS:"Keywords",DESC:"Desc",TO_MY_LIST:"To my list",ANGEL:"Angel Stage",PRE_A:"Pre-Series A",A:"Series A",B:"Series B",C:"Series C",D:"Series D",E:"Series E",LATE_STAGE:"Late Stage",UNKNOWN:"Unknown",OVERVIEW:"Overview",TRENDS:"Trends",TEAM:"Team",WEBSITE:"Website",LINKS:"Links",FUNDING_ROUNDS:"Funding Rounds",SIMILAR_COMPANIES:"Similar Companies",ROUND:"Round",AMOUNT:"Amount",DATE:"Date",INVESTORS:"Investors",LISTS_FEATURING:"Lists featuring",RELATED_LISTS:"Related Lists",EXSITING:"Exsiting",LISTS:"Lists",ADD:"Add",TO_A_LIST:"to a List",ADD_TO_A_LIST:"Add to a List",NOTE:"Note",POSITION:"Position",JOIN_DATE:"Join Date",EDUCATION:"Education",EXPERIENCE:"Experience",WRITE_NOTE:"Write Note",SAVE:"Save",COMPARE:"Compare",SEARCH_INVESTOR:"Search the companies invested by",UNKNOWN:"Unknown",HEADCOUNT:"HeadCount",COMPANY_NAME:"Company Name",START_A_NEW_LIST:"Start a New List",CREATED_LISTS:"Created Lists",SHARED_LISTS:"Shared Lists",CREATE_A_NEW_LIST:"Create a New List",ADD_COMPANY_TO_LIST:"Add Companies to List",EDIT_LIST:"Edit list",COMFIRM:"Comfirm",SHARE:"Share",CLOSE_SHARE:"Close Share",HIDE:"hide",CREATE:"create",CONTAINS:"Contains",FOLLOWING:"Following",SET_ALERT:"Set Alert",LOAD_MORE_DATA:"Load More Data",WRITE_DESCRIBTION:"Write describtion",PRIVATE:"Private",PUBLIC:"Public",EDIT:"Edit",DELETE:"Delete",TO_OTHER_LIST:"to other list",FROM_LIST:"from list",UNFOLLOW:"unfollow",DELETING_COMFIRM:"You are deleting ... Please comfirm",YES:"Yes",NO:"No",WITH:"Each List relates about",RELATED_HINT:"",EXSIT:"",EXSITING_HINT:"is exsiting in the lists",CREATE_A_NEW_SEARCH:"Create a New Search",SAVED_SEARCHES_NULL:"You don't have any saved searches. Create one from the",COMPANY_SEARCH_PAGE:"Company Search Page",UPDATE_NOTE_SUCCESS:"Updated note successfully",CREATE_NEW_LIST_SUCCESS:"Created new list successfully",ADD_TO_SELECTED_LIST:"Added to list successfully",UPDATE_LIST_SUCCESS:"Updated list successfully",SHARE_SUCCESS:"Shared successfully",CLOSE_SHARE_SUCCESS:"Closed share successfully",DELETE_FROM_LIST:"Deleted from list successfully",SAVED:"Saved",DELETED:"Deleted"}).translations("cn",{LANGUAGE:"Language",SEARCH:"搜索",LOGOUT:"退出",HOME:"主页",COMPANY_SEARCH:"公司搜索",SAVED_SEARCHES:"搜索结果",MY_LIST:"我的列表",LIST_SEARCH:"列表搜索",MORE:"更多",WELCOME:"欢迎",MESSAGEINFO:"信息栏",MENU:"菜单",PROFILE:"信息",WELCOME_DESC:"选择你的开始方式",SEARCH_DESC:"通过过滤条件搜索公司",SEARCHES_DESC:"保存你的搜索信息",LIST_DESC:"添加公司到你的列表",FOLLOWING_DESC:"记录关注的公司",LATEST_EVENTS:"最新事件",READ_MORE:"全文",SEARCHBY:"搜索条件",KEYWORD:"关键字",LOCATION:"地区",INVESTOR:"投资方",STAGE:"阶段",FINANCE:"估值",FOUNDED:"建立时间",STATUS:"状态",DATA:"数据",EVENTS:"事件",COMPANY:"公司",COMPANIES:"公司",SAVE_SEARCH:"保存搜索",FILTER:"筛选",AFTER:"从",BEFORE:"至",STATE:"省份",COUNTRY:"国家",INVESTORS:"投资方",RELATION:"关联",NAME:"公司名",TAG_HINT:"你可能也想添加",ADD_FILTER:"请添加过滤条件",SAVE_SEARCH_SUCCESS:"成功保存搜索",NAME_FILTER:"筛选公司名",KEYWORD_FILTER:"筛选关键字",LOCATION_FILTER:"筛选地区",KEYWORDS:"关键字",DESC:"描述",TO_MY_LIST:"到我的列表",ANGEL:"天使轮",PRE_A:"Pre-A",A:"A轮",B:"B轮",C:"C轮",D:"D轮",E:"E轮",LATE_STAGE:"后期阶段",UNKNOWN:"未知",OVERVIEW:"总览",TRENDS:"趋势",TEAM:"团队",WEBSITE:"网站",LINKS:"社交平台",FUNDING_ROUNDS:"融资历史",SIMILAR_COMPANIES:"类似公司",ROUND:"轮次",AMOUNT:"金额",DATE:"时间",INVESTORS:"投资人",LISTS_FEATURING:"列表展示",RELATED_LISTS:"相关列表",EXSITING:"存在的",LISTS:"列表",ADD:"添加",TO_A_LIST:"到列表中",ADD_TO_A_LIST:"加到列表中",NOTE:"记录",POSITION:"职位",JOIN_DATE:"加入时间",EDUCATION:"教育",EXPERIENCE:"经历",WRITE_NOTE:"输入批注",SAVE:"保存",COMPARE:"比较",SEARCH_INVESTOR:"搜索投资过的公司by",UNKNOWN:"不明确",HEADCOUNT:"员工",COMPANY_NAME:"公司全称",START_A_NEW_LIST:"创建新的列表",CREATED_LISTS:"创建的列表",SHARED_LISTS:"共享的列表",CREATE_A_NEW_LIST:"创建新列表",ADD_COMPANY_TO_LIST:"添加公司到列表中",EDIT_LIST:"编辑列表",COMFIRM:"确认",SHARE:"分享",CLOSE_SHARE:"关闭分享",HIDE:"隐藏",CREATE:"创建",CONTAINS:"包含",FOLLOWING:"关注",SET_ALERT:"设置提醒",LOAD_MORE_DATA:"加载更多数据",WRITE_DESCRIBTION:"描述信息",PRIVATE:"未公开",PUBLIC:"公开",EDIT:"编辑",DELETE:"删除",TO_OTHER_LIST:"到其他列表",FROM_LIST:"从列表中",UNFOLLOW:"取消关注",DELETING_COMFIRM:"你正在进行删除操作... 请确认",YES:"确认",NO:"取消",WITH:"与",RELATED_HINT:"特征相关的列表",EXSIT:"存在",EXSITING_HINT:"的列表",CREATE_A_NEW_SEARCH:"创建新的搜索",SAVED_SEARCHES_NULL:"尚未保存搜索结果。创建一个新的搜索在",COMPANY_SEARCH_PAGE:"公司搜索页",UPDATE_NOTE_SUCCESS:"成功保存批注",CREATE_NEW_LIST_SUCCESS:"成功创建新的列表",ADD_TO_SELECTED_LIST:"成功添加到所选列表",UPDATE_LIST_SUCCESS:"成功更新列表",SHARE_SUCCESS:"成功分享",CLOSE_SHARE_SUCCESS:"成功关闭分享",DELETE_FROM_LIST:"成功从列表中删除",SAVED:"保存",DELETED:"删除"}),E.preferredLanguage("en")}angular.module("gobi").config(config);